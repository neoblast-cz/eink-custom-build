{% extends "base.html" %}
{% block title_suffix %} - Habits Settings{% endblock %}
{% block content %}
<h2>Configure: Habits</h2>

<div class="settings-form">
  <h3>Google Sheet</h3>
  <p class="hint">
    Create a Google Sheet with this layout:
  </p>
  <ol class="hint">
    <li>Column A: <strong>Date</strong> (e.g. 2026-02-22)</li>
    <li>Columns B, C, D...: habit names as headers (e.g. Exercise, Read, Meditate)</li>
    <li>Use checkboxes (TRUE/FALSE) in the data cells</li>
    <li>Enable the <strong>Google Sheets API</strong> in your <a href="https://console.cloud.google.com/apis/library/sheets.googleapis.com" target="_blank">Google Cloud Console</a></li>
  </ol>

  <form method="POST">
    <label for="spreadsheet_id">Spreadsheet ID</label>
    <input type="text" id="spreadsheet_id" name="spreadsheet_id"
           value="{{ settings.spreadsheet_id | default('') }}"
           placeholder="Paste the ID from the sheet URL">
    <p class="hint">Find it in the URL: docs.google.com/spreadsheets/d/<strong>SPREADSHEET_ID</strong>/edit</p>

    <label for="max_display">Max habits to display</label>
    <input type="number" id="max_display" name="max_display"
           value="{{ settings.max_display | default(8) }}" min="1" max="12">

    <div class="form-actions">
      <button type="submit" class="btn-primary">Save Settings</button>
      <a href="/" class="btn-secondary">Cancel</a>
    </div>
  </form>

  <hr style="border-color: #444; margin: 1.5rem 0;">

  <h3>Authorization</h3>
  <p class="hint">Uses Google API credentials from the main <a href="/">Settings</a> page.</p>
  {% if sheets_authorized %}
    <p style="color: #6f6;">Authorized with Google Sheets</p>
    <a href="/oauth/google/sheets/start" class="btn-secondary">Re-authorize</a>
  {% else %}
    <a href="/oauth/google/sheets/start" class="btn-primary">Authorize with Google</a>
  {% endif %}

  {% if settings.spreadsheet_id %}
  <hr style="border-color: #444; margin: 1.5rem 0;">
  <a href="https://docs.google.com/spreadsheets/d/{{ settings.spreadsheet_id }}/edit" target="_blank" class="btn-secondary">Open Google Sheet</a>
  {% endif %}
</div>
{% endblock %}
